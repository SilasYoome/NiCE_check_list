<!doctype html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>攤位採買清單｜手機友善</title>
  <style>
    :root{
      --bg:#0b1020;--card:#121a2c;--text:#eaf2ff;--muted:#aab7cf;--accent:#0ea5e9;--ok:#10b981;
      --radius:16px;--shadow:0 6px 18px rgba(0,0,0,.35);
    }
    @media (prefers-color-scheme: light){:root{--bg:#f7f9fc;--card:#fff;--text:#0f172a;--muted:#465268;--accent:#0284c7;--shadow:0 6px 18px rgba(2,8,23,.08);}}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans TC","PingFang TC","Microsoft JhengHei",sans-serif}

    /* Grid：手機1欄、平板2欄、桌機3欄 */
    .grid{display:grid;gap:14px;max-width:980px;margin:20px auto;padding:0 14px}
    @media (min-width:640px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media (min-width:980px){.grid{grid-template-columns:repeat(3,1fr)}}

    /* 卡片 */
    .card{background:var(--card);border-radius:var(--radius);padding:12px;box-shadow:var(--shadow);border:1px solid color-mix(in srgb, var(--text) 12%, transparent)}
    .card[data-bought="true"]{opacity:.55}

    /* 頂列 */
    .top{display:flex;justify-content:space-between;align-items:center;gap:12px}
    .left{display:flex;align-items:center;gap:10px;min-height:44px}
    .badge{font-size:1.6rem;font-weight:800;background:var(--accent);color:#fff;padding:10px 14px;border-radius:12px}
    .stall-name{font-weight:800;font-size:1.1rem}
    .buyBtn{border:none;border-radius:999px;padding:10px 14px;background:color-mix(in srgb, var(--ok) 18%, var(--card));color:var(--ok);font-weight:800;cursor:pointer;box-shadow:inset 0 0 0 1px color-mix(in srgb, var(--ok) 45%, transparent)}

    /* 物品清單（整塊可點、較大觸控面積） */
    .items{display:flex;flex-direction:column;gap:10px;margin:12px 0}
    .item{display:flex;align-items:center;gap:12px;background:#1a2236;padding:12px 12px;border-radius:12px;border:1px solid color-mix(in srgb, var(--text) 10%, transparent);cursor:pointer;min-height:56px}
    .item input[type=checkbox]{width:22px;height:22px}
    .item span.txt{flex:1;font-size:1.06rem}
    .item img{width:72px;height:72px;object-fit:cover;border-radius:10px;border:1px solid color-mix(in srgb, var(--text) 10%, transparent)}
    .item:has(input:checked){outline:2px solid color-mix(in srgb, var(--ok) 65%, white);outline-offset:2px}

    /* 主圖（縮小顯示） */
    .hero img{width:100%;height:auto;max-height:180px;object-fit:cover;border-radius:12px;border:1px solid color-mix(in srgb, var(--text) 10%, transparent)}
  </style>
</head>
<body>
  <main class="grid" id="grid">
    <article class="card" data-id="A01" data-manual="false">
      <div class="top">
        <div class="left"><span class="badge">D01</span><span class="stall-name">KanArtwork</span></div>
        <button class="buyBtn">✔ 全選</button>
      </div>
      <div class="items">
        <label class="item"><input type="checkbox" id="A01-1"><span class="txt">台灣騎樓娃包</span><img src="./D31.jpg" alt="台灣騎樓娃包"></label>
      </div>
      <div class="hero"><img src="D31_1.jpg" alt="主商品"></div>
    </article>

    <article class="card" data-id="011" data-manual="false">
      <div class="top">
        <div class="left"><span class="badge">J23</span><span class="stall-name"> WUNDERKAMMER-好奇收藏所-</span></div>
        <button class="buyBtn">✔ 全選</button>
      </div>
      <div class="items">
        <label class="item"><input type="checkbox" id="B12-1"><span class="txt">刺繡手環-馬利醫生</span><img src="J23.png" alt="雞腿排"></label>
      </div>
      <div class="hero"><img src="J23_1.png" alt="主商品"></div>
    </article>

    <article class="card" data-id="J23" data-manual="false">
      <div class="top">
        <div class="left"><span class="badge">J23</span><span class="stall-name">火燒酒螺</span></div>
        <button class="buyBtn">✔ 全選</button>
      </div>
      <div class="items">
        <label class="item"><input type="checkbox" id="B12-1"><span class="txt">林薩明信片*5(各組) $100</span><img src="O11.jpg" alt="雞腿排"></label>
      </div>
      <div class="hero"><img src="J23_1.png" alt="主商品"></div>
    </article>
  </main>

  <script>
    const grid = document.getElementById('grid');

    function setAll(card, checked){
      card.querySelectorAll('.items input[type="checkbox"]').forEach(cb=>{cb.checked = checked});
    }

    function recompute(card){
      const total = card.querySelectorAll('.items input[type="checkbox"]').length;
      const done  = card.querySelectorAll('.items input[type="checkbox"]:checked').length;
      const manual= card.dataset.manual === 'true';
      const auto  = (total>0 && done===total);
      const final = manual || auto;
      card.dataset.bought = final ? 'true' : 'false';
    }

    function resort(){
      const cards = [...grid.children];
      const notBought = cards.filter(c=>c.dataset.bought!=='true');
      const bought    = cards.filter(c=>c.dataset.bought==='true');
      for(const c of [...notBought, ...bought]) grid.appendChild(c);
    }

    function attach(card){
      const btn = card.querySelector('.buyBtn');
      btn.addEventListener('click',()=>{
        const manual = card.dataset.manual === 'true';
        const next = !manual;
        card.dataset.manual = next ? 'true' : 'false';
        // 同步清單：按下已購→全選；取消已購→全不選
        setAll(card, next);
        recompute(card); resort();
      });

      // 整塊可點（<label> 已支援）；監聽變化即可
      card.querySelectorAll('.items input[type="checkbox"]').forEach(cb=>{
        cb.addEventListener('change',()=>{recompute(card); resort();});
      });

      recompute(card);
    }

    document.querySelectorAll('.card').forEach(attach);
  </script>
</body>
</html>
